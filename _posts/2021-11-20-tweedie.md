---
keywords: fastai
description: A short introduction to the Tweedie distribution
title: Tweedie distribution
toc: true 
badges: true
comments: false
categories: [insurance, distribution, glm, notebook]
nb_path: _notebooks/2021-11-20-tweedie.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-11-20-tweedie.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introduction">Introduction<a class="anchor-link" href="#Introduction"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="https://en.wikipedia.org/wiki/Tweedie_distribution">Tweedie distribution</a> is a family of probability distributions that include</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Normal_distribution">Normal</a></li>
<li><a href="https://en.wikipedia.org/wiki/Gamma_distribution">Gamma</a></li>
<li><a href="https://en.wikipedia.org/wiki/Inverse_Gaussian_distribution">Inverse Gaussian</a></li>
<li><a href="https://en.wikipedia.org/wiki/Poisson_distribution">Poisson</a></li>
<li><a href="https://en.wikipedia.org/wiki/Compound_Poisson_distribution#Compound_Poisson_Gamma_distribution">Compound Poisson-gamma</a></li>
</ul>
<p>The Tweedie distribution is wildly popular in insurance industry as a tool of modelling</p>
<ul>
<li>claim frequency (count data), </li>
<li>claim severity (non-negative continuous data), and </li>
<li>pure premium (non-negative continous data with a zero mass).</li>
</ul>
<p>In this post, we give a brief introduction to the Tweedie distribution and its properties.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Exponential-Dispersion-Models">Exponential Dispersion Models<a class="anchor-link" href="#Exponential-Dispersion-Models"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before diving into the Tweedie distribution, we need to understand the <strong>exponential dispersion model (EDM)</strong> ((Jorgensen, 1986, 1987a; Tweedie, 1947), of which the Tweedie is a special case.</p>
<p>A probability distribution is an <strong>EDM</strong> if the density/mass function has the following form</p>
<p>{% raw %}
$$f(y) = c(y, \phi)\exp\left\{\frac{y\theta- a(\theta)}{\phi}\right\},$$
{% endraw %}
where $\theta$ is called the canonical parameter and $\phi$ the dispersion parameter.</p>
<p>It can be shown that,
{% raw %}
$$\mathbb{E}(y):=\mu = \dot{a}(\theta), \quad \mathrm{Var}(y)=\phi\ddot{a}(\theta)= \phi\ddot{a}(\dot{a}^{-1}(\mu))=\phi V(\mu)$$
{% endraw %}</p>
<p>where $\dot{a}$ and $\ddot{a}$ are the first and second derivative of $a$, respectively; $V(\mu)$ is called the variance function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Tweedie-Distribution">Tweedie Distribution<a class="anchor-link" href="#Tweedie-Distribution"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we formally introduce the Tweedie distribution. A Tweedie distribution is an EDM with 
{% raw %}
$$V(\mu) = \mu^p, $$
{% endraw %}
where $p\in \mathrm{R}$. The Tweedie behaves differently when $p$ takes different values.</p>
<p>We consider 5 cases.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Normal-($p=0$)">Normal ($p=0$)<a class="anchor-link" href="#Normal-($p=0$)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When $p=0$, the Tweedie distribution becomes a normal distribution with the mean equal to $\mu$ and variance as $\phi$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Poisson-($p=1$)">Poisson ($p=1$)<a class="anchor-link" href="#Poisson-($p=1$)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When $p=1$, the Tweedie distribution becomes a Poisson distribution if we set $\phi=1$. The resulting Poison mean and variance equal to $\mu$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Gamma-Distribution-($p=2$)">Gamma Distribution ($p=2$)<a class="anchor-link" href="#Gamma-Distribution-($p=2$)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Inverse-Gaussian-Distribution-($p=3$)">Inverse Gaussian Distribution ($p=3$)<a class="anchor-link" href="#Inverse-Gaussian-Distribution-($p=3$)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Compound-Poisson-Gamma-($1&lt;p&lt;2$)">Compound Poisson-Gamma ($1&lt;p&lt;2$)<a class="anchor-link" href="#Compound-Poisson-Gamma-($1&lt;p&lt;2$)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When $1&lt;p&lt;2$, the Tweedie distribution gives rise to a very interesting class known as the <a href="https://en.wikipedia.org/wiki/Compound_Poisson_distribution">Compound Poisson-Gamma Distribution</a>.</p>
<p>A compound Poisson-Gamma distribution is the distribution of a sum of i.i.d gamma distribution with the number of gamma following a Poisson distribution.</p>
<p>To illusrate the idea, let $N\sim \mathrm{Poisson}(\lambda)$, and $X_i\sim \Gamma(\alpha, \beta)$, $i=1,2,\dots,N$ be i.i.d gamma distributions. Then 
{% raw %}
$$Y=\sum_{i=1}^N X_i$$
{% endraw %}
is a compound Poisson-Gamma distribution.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Mean and Variance</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To calculate the mean of $Y$,</p>
$$
\begin{array}{ll}
\mathbb{E}(Y) &amp;=&amp; \mathbb{E}(\mathbb{E}(Y|N)) &amp;(\text{Law of Total Expectation})\\
              &amp;=&amp; \mathbb{E}(N\mathbb{E}(X_1))&amp;(\text{i.i.d assumption})\\
              &amp;=&amp; \mathbb{E}(N\alpha/\beta)  &amp;(\text{Mean of Gamma distribution})\\
              &amp;=&amp;\lambda\frac{\alpha}{\beta}  &amp; (\text{Mean of Poisson distribution})
\end{array}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To calculate the variance,</p>
$$
\begin{array}{ll}
\mathrm{Var}(Y) &amp;=&amp; \mathrm{Var}(\mathbb{E}(Y|N)) + \mathbb{E}(\mathrm{Var}(Y|N))&amp; (\text{Law of Total Variance})\\
                &amp;=&amp; \mathrm{Var}(N\mathbb{E}(X_1)) + \mathbb{E}(N\mathrm{Var}(X_1)) &amp;(\text{i.i.d assumption})\\
                &amp;=&amp; \mathrm{Var}(N\alpha/\beta) + \mathbb{E}(N\alpha/\beta^2) &amp; (\text{Mean and variance of Gamma distribution})\\
                &amp;=&amp;  \lambda\alpha^2/\beta^2 + \lambda\alpha/\beta^2 &amp;(\text{Mean and variance of Poisson distribution})\\
                &amp;=&amp; \lambda \frac{\alpha(1+\alpha)}{\beta^2} &amp; \\
\end{array}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Parameter Mapping</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$
\lambda =\frac{\mu^{2-p}}{(2-p)\phi}, \quad\alpha=\frac{2-p}{p-1},\quad  \beta= \frac{\mu^{1-p}}{(p-1)\phi}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Scale-Invariance">Scale Invariance<a class="anchor-link" href="#Scale-Invariance"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let c be a positive constant, c &gt; 0, and Y a random variable from a certain family
of distributions; we say that this family is scale invariant if cY follows a distribution
in the same family. This property is desirable if Y is measured in a monetary
unit: if we convert the data from one currency to another, we want to stay within the
same family of distributionsâ€”the result of a tariff analysis should not depend on the
currency used.</p>
<p>It can be shown that the only EDMs that are scale invariant are the so called
Tweedie models, which are defined as having variance function
v(Î¼) = Î¼p (2.9)
for some p. The proof can be found in JÃ¶rgensen [JÃ¶97, Chap. 4], upon</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Tweedie-Deviance">Tweedie Deviance<a class="anchor-link" href="#Tweedie-Deviance"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% cite jorgensen1992exponential -A%}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The EDM was proposed by #</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% cite jorgensen1992exponential %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="References">References<a class="anchor-link" href="#References"> </a></h1><p>{% bibliography --cited %}</p>

</div>
</div>
</div>
</div>
 

